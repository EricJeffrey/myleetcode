# 零碎知识记录

### Elasticsearch的索引原理：
- 对文档建立倒排索引: term->posting list
- 对term建立字典索引: term prefix->term list (使用有限状态机实现)
- 多个field联合查询: 对查询到的多个posting list，使用跳表或bitset查询交集
- 压缩posting list: 增量压缩 -- 记录排序后a[i+1]-a[i]的值）
- 压缩posting list: roaring bitmap -- 使用除65536的 商+余数 标识每个数据

### B树与B+树
- MySQL - B+树，MongoDB - B树
- B树 - 所有节点保存数据，不适合范围查询，但点查询可能在O(1)
- B+树 - 仅叶子节点保存数据，且叶子相连，可以范围查询，点查询稳定为O(lgn)

### HTTP1.0 -- 1.1 -- 2.0
- 1.1 - 长连接
- 2.0 - 二进制格式，连接共享（复用），服务端推送
- 服务端推送：服务端把尚未请求的数据返回（附加在其他请求）并标明请求路径

### 管道与共享内存在应用上的区别（优缺点）
- 数据方面 - 管道传递消息，共享内存发布消息
- 访问方面 - 管道以同步方式工作，读/写时会阻塞；共享内存以异步方式工作，手动检查是否有数据，但读/写操作需要手动同步管理
- 可用性 - FIFO在文件系统中可见，共享内存需要特殊机制访问与管理
- 资源方面 - 管道的缓冲由系统控制，共享内存手动分配大小
- 因此 - 管道需要在用户态和内核态缓冲区之间拷贝，共享内存通过mmap不需要拷贝

### 为什么用(独立的)消息队列
- 应用崩溃时消息不受影响
- 方便扩展，比如消息类型
- 持久化可以独立进行
- 批处理消息，高低优先级处理